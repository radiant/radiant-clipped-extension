- new_attachment ||= @page_attachment
- page = @page || new_attachment.page
- asset = @asset || new_attachment.asset
- asset_type = asset.image? ? "image" : "link"
- dom_id = "asset_#{asset.id}"

%li{:class => "#{asset_type} asset unsaved", :id => dom_id}
  .front
    .thumbnail
      = image_tag asset.thumbnail(:sample)
  .back
    .title= asset.title
    %ul.actions
      - asset_size = Radiant.config['assets.insertion_size'] || 'normal'
      %li= link_to t('assets_extension.insert'), '#', :class => 'insert_asset', :rel => "#{asset_size}_#{asset.id}"
      %li= link_to t('assets_extension.detach').downcase, '#', :class => 'detach_asset'
      - fields_for :page, page do |f|
        - f.fields_for :page_attachments, new_attachment, :child_index => asset.uuid do |paf|
          = paf.hidden_field :asset_id, :class => 'attacher'

